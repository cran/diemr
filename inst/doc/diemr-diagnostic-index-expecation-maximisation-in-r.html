<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Natália Martínková" />

<meta name="date" content="2023-07-11" />

<title>diemr: Diagnostic index expectation maximisation in R</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">diemr: Diagnostic index expectation
maximisation in R</h1>
<h4 class="author">Natália Martínková</h4>
<h4 class="date">2023-07-11</h4>



<div id="quick-start" class="section level1">
<h1>Quick start</h1>
<p>The package <code>diemr</code> incorporates the diagnostic index
expectation maximisation algorithm used to estimate which genomic
alleles belong to which side of a barrier to geneflow. To start using
<code>diemr</code>, load the package or install it from CRAN if it is
not yet available:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempt to load a package, if the package was not available, install and load</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;diemr&quot;</span>, <span class="at">character.only =</span> <span class="cn">TRUE</span>)){</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">&quot;diemr&quot;</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(<span class="st">&quot;diemr&quot;</span>, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Next, assemble paths to all files containing the data to be used by
<code>diemr</code>. Here, we will use a tiny example dataset that is
included in the package for illustrating the analysis workflow. A good
practice is to check that all files contain data in the correct format
for all individuals and markers. Additionally, the analysis will need a
list with ploidies for all genomic compartments and individuals, and a
vector with indices of samples that will be included in the
analysis.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>filepaths <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;data6x3.txt&quot;</span>, <span class="at">package =</span> <span class="st">&quot;diemr&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming diploid markers of all individuals</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>ploidies <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">6</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysing all individuals</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">CheckDiemFormat</span>(<span class="at">files =</span> filepaths, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">ChosenInds =</span> samples,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">ploidy =</span> ploidies)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># File check passed: TRUE</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ploidy check passed: TRUE</span></span></code></pre></div>
<p>If the <code>CheckDiemFormat()</code> function fails, work through
the error messages and fix the stored input files accordingly. The
algorithm repeatedly accesses data from the harddisk, so seeing the
passed file and variable check prior to the analysis is critical.</p>
<p>To estimate the marker polarities, their diagnostic indices and
support, run the function <code>diem()</code> with default settings.
Here, we have only one file with data, so paralelisation is unnecessary,
and we set <code>nCores = 1</code>. <strong>This setting must always be
used on Windows</strong>. Other operating systems can process multiple
genomic compartments (e.g.  chromosomes) in parallel, and the analysis
of different genomic compartment files can run on multiple
processors.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">diem</span>(<span class="at">files =</span> filepaths, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">ploidy =</span> ploidies, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">markerPolarity =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">ChosenInds =</span> samples, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">nCores =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The result is a list, where the element <code>res$DI</code> contains
a table with marker polarities, their diagnostic indices and
support.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>DI</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   newPolarity         DI   Support Marker</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1       FALSE  -4.872256 15.930181      1</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2        TRUE  -3.520647 18.633399      2</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3        TRUE -13.274822  6.130625      3</span></span></code></pre></div>
<p>The column <code>newPolarity</code> means that marker 1 should be
imported for subsequent analyses as is, and markers 2 and 3 should be
imported with 0 replaced with 2 and 2 replaced with 0. The marker 3 has
the lowest diagnostic index and low support, indicating that the
genotypes scored at this marker are poorly related to the barrier to
geneflow arbitrated by the data.</p>
<p>With the marker polarities optimised to detect a barrier to geneflow,
a plot of the polarised genome will show how genomic regions cross the
barrier. First, the genotypes need to be imported with optimal marker
polarities. Second, individual hybrid indices need to be calculated from
the polarised genotypes. And last, the data will be plotted as a raster
image.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>genotypes <span class="ot">&lt;-</span> <span class="fu">importPolarized</span>(<span class="at">file =</span> filepaths, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">changePolarity =</span> res<span class="sc">$</span>markerPolarity, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ChosenInds =</span> samples)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                             </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="at">X =</span> res<span class="sc">$</span>I4, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">MARGIN =</span> <span class="dv">1</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">FUN =</span> pHetErrOnStateCount)[<span class="dv">1</span>, ]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPolarized</span>(<span class="at">genotypes =</span> genotypes,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">HI =</span> h)</span></code></pre></div>
<p><img src="data:image/png;base64,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CBAgQIBA4wQEoMaV3IQJECBAgAABAcg+QIAAAQIECDROQABqXMlNmAABAgQIEBCA7AMECBAgQIBA4wQEoMaV3IQJECBAgAABAcg+QIAAAQIECDROQABqXMlNmAABAgQIEBCA7AMECBAgQIBA4wQEoMaV3IQJECBAgAABAcg+QIAAAQIECDROQABqXMlNmAABAgQIEBCA7AMECBAgQIBA4wQEoMaV3IQJECBAgAABAcg+QIAAAQIECDROQABqXMlNmAABAgQIEBCA7AMECBAgQIBA4wQEoMaV3IQJECBAgAABAcg+QIAAAQIECDROQABqXMlNmAABAgQIEBCA7AMECBAgQIBA4wQEoMaV3IQJECBAgAABAcg+QIAAAQIECDROQABqXMlNmAABAgQIEBCA7AMECBAgQIBA4wQEoMaV3IQJECBAgAABAcg+QIAAAQIECDROQABqXMlNmAABAgQIEBCA7AMECBAgQIBA4wQEoMaV3IQJECBAgAABAcg+QIAAAQIECDROQABqXMlNmAABAgQIEBCA7AMECBAgQIBA4wQEoMaV3IQJECBAgAABAcg+QIAAAQIECDROQABqXMlNmAABAgQIEBCA7AMECBAgQIBA4wQEoMaV3IQJECBAgACBYQjeuMCil15641/2TQIECGQU2GjEiIy965pAfgEB6A3WIIWfcf877Q1+29cIECCQV2DJD6bnHYDeCWQWcAoscwF0T4AAAQIECHRfQADqvrkeCRAgQIAAgcwCAlDmAuieAAECBAgQ6L6AANR9cz0SIECAAAECmQUEoMwF0D0BAgQIECDQfQEBqPvmeiRAgAABAgQyCwhAmQugewIECBAgQKD7AgJQ9831SIAAAQIECGQWEIAyF0D3BAgQIECAQPcFBKDum+uRAAECBAgQyCwgAGUugO4JECBAgACB7gsIQN031yMBAgQIECCQWUAAylwA3RMgQIAAAQLdFxCAum+uRwIECBAgQCCzgACUuQC6J0CAAAECBLovIAB131yPBAgQIECAQGYBAShzAXRPgAABAgQIdF9AAOq+uR4JECBAgACBzAICUOYC6J4AAQIECBDovoAA1H1zPRIgQIAAAQKZBQSgzAXQPQECBAgQINB9AQGo++Z6JECAAAECBDILCECZC6B7AgQIECBAoPsCAlD3zfVIgAABAgQIZBYQgDIXQPcECBAgQIBA9wUEoO6b65EAAQIECBDILCAAZS6A7gkQIECAAIHuCwhA3TfXIwECBAgQIJBZQADKXADdEyBAgAABAt0XEIC6b65HAgQIECBAILOAAJS5ALonQIAAAQIEui8gAHXfXI8ECBAgQIBAZgEBKHMBdE+AAAECBAh0X0AA6r65HgkQIECAAIHMAgJQ5gLongABAgQIEOi+gADUfXM9EiBAgAABApkFBKDMBdA9AQIECBAg0H0BAaj75nokQIAAAQIEMgsIQJkLoHsCBAgQIECg+wICUPfN9UiAAAECBAhkFhCAMhdA9wQIECBAgED3BYZ1v0s9EiBAgEB2gfkbZB+CAfSxwJhvRoz8QtETdASo6PIYHAECBAgQIFCHgABUh6o2CRAgQIAAgaIFBKCiy2NwBAgQIECAQB0CAlAdqtokQIAAAQIEihYQgIouj8ERIECAAAECdQgIQHWoapMAAQIECBAoWkAAKro8BkeAAAECBAjUISAA1aGqTQIECBAgQKBoAQGo6PIYHAECBAgQIFCHgABUh6o2CRAgQIAAgaIFBKCiy2NwBAgQIECAQB0CAlAdqtokQIAAAQIEihYQgIouj8ERIECAAAECdQgIQHWoapMAAQIECBAoWkAAKro8BkeAAAECBAjUISAA1aGqTQIECBAgQKBoAQGo6PIYHAECBAgQIFCHgABUh6o2CRAgQIAAgaIFBKCiy2NwBAgQIECAQB0CAlAdqtokQIAAAQIEihYQgIouj8ERIECAAAECdQgIQHWoapMAAQIECBAoWkAAKro8BkeAAAECBAjUISAA1aGqTQIECBAgQKBoAQGo6PIYHAECBAgQIFCHgABUh6o2CRAgQIAAgaIFBKCiy2NwBAgQIECAQB0CAlAdqtokQIAAAQIEihYQgIouj8ERIECAAAECdQgIQHWoapMAAQIECBAoWkAAKro8BkeAAAECBAjUISAA1aGqTQIECBAgQKBoAQGo6PIYHAECBAgQIFCHgABUh6o2CRAgQIAAgaIFBKCiy2NwBAgQIECAQB0CAlAdqtokQIAAAQIEihYQgIouj8ERIECAAAECdQgIQHWoapMAAQIECBAoWkAAKro8BkeAAAECBAjUISAA1aGqTQIECBAgQKBoAQGo6PIYHAECBAgQIFCHgABUh6o2CRAgQIAAgaIFhqx8bSl6hKUObsXzEU+8rdTRGVcfCIw+8+g+mIUplCrwP9NLHZlx9YPAhNMPjX1P2afoqTgCVHR5DI4AAQIECBCoQ0AAqkNVmwQIECBAgEDRAgJQ0eUxOAIECBAgQKAOAQGoDlVtEiBAgAABAkULDDoADbxW+umnn47f/e53sWDBgqInZ3AECBAgQIAAgVYCgwpA5557buywww7V9x966KHYfvvtY8KECfG2t70trrrqqlbtWkeAAAECBAgQKFagYwB68MEH44QTTog999wz0lGgM844I4YNGxa33nprTJkyJSZPnlzs5AyMAAECBAgQINBKoGMAuv3222PbbbeNGTNmxJAhQ+Lyyy+Pww8/PHbfffeYNm1aPP7447Fw4cJWbVtHgAABAgQIEChSoGMAeu6552KTTTapBj937tx48sknY//996/ev/LKK9XRoBEjRhQ5OYMiQIAAAQIECLQS6BiAdtlll5gzZ07cdNNNcdZZZ8X6668f++23XyxdujS+9a1vxfvf//4YNWpUq7atI0CAAAECBAgUKTCs06j23nvvOPjgg2OvvfaqPvrDH/4wRo4cGUcddVR1Ouy8887r1ITtBAgQIECAAIGiBDoGoDTamTNnxrx582L06NExduzYagLpAuizzz7b0Z+iymkwBAgQIECAwGAEBhWA0sXPO+644xrtvec971njvTcECBAgQIAAgV4RaBmA7rrrrrj55psHPYfPf/7zg/6sDxIgQIAAAQIEcgu0DEA33nhjdYv7YAcnAA1WyucIECBAgACBEgRa3gX2hS98IdIt7oP9K2EixkCAAAECBAgQGKxAywA02C+nzy1atOj1fNxnCRAgQIAAAQLZBVqeAvvXUV177bVxzjnnxLPPPhuvvvpqtTn9+9JLL0V6VEY6UmQhQIAAAQIECPSKQMcjQPPnz49DDjmkevbXOuusE+nXoDfbbLNYvHhx3HvvvfGd73ynV+ZqnAQIECBAgACBSqDjEaDZs2fHihUrIj0FPh31SY/FuPjii2ODDTaIY489Nh5++GGUBAgQIECAAIGeEuh4BGjBggXV4y423HDD6ocQN99880gPSE2/DfSVr3wlzj///Fi+fHlPTdpgCRAgQIAAgWYLdAxAW2+9dTzyyCOrld71rnfFLbfcUr3faKONqn/TE+EtBAgQIECAAIFeEegYgHbffffqep9JkyZVd3yl9+kUWLoW6Lvf/W51SmzcuHG9Ml/jJECAAAECBAhExwCULni+4IIL4qqrroqFCxdW1/2ka4LSU+K/9rWvxTHHHFOdDmNJgAABAgQIEOgVgY4XQaeJTJw4MQ499NAYOnRo9XfnnXfGNddcE+l5YNtss02vzNU4CRAgQIAAAQKVQMcA9Oc//7njYzHSozMsBAgQIECAAIFeEegYgIYPHx7pzq+By9KlS+P++++PdPHziSeeOHCT1wQIECBAgACB4gU6BqDx48fHz3/+87UmsnLlyvjc5z4Xjz322FrbrCBAgAABAgQIlCzQ8SLodoNPvwN00kknxaxZs+KFF15o9zHrCRAgQIAAAQLFCbzhAJRm8tRTT1W/Dr1kyZLiJmZABAgQIECAAIF2Ah1PgT366KNx2WWXrfH99EiM559/vvoV6PTDiFtuueUa270hQIAAAQIECJQs0DEAzZs3L04++eS15pCeBbbrrrvGD37wg7W2WUGAAAECBAgQKFmgYwA66KCD4pVXXil5DsZGgAABAgQIEHhdAv/RNUCvqycfJkCAAAECBAgUItDyCNDMmTNjxowZgx7i9ddfP+jP+iABAgQIECBAILdAyyNAI0aMiE033XT13zPPPBM33HBDpN/+2X777WP06NExZ86cat3YsWNzz0H/BAgQIECAAIHXJdDyCNDBBx8c6S8tCxYsiJ122ikuueSSOPLII1c3vnz58pgyZUqki6QtBAgQIECAAIFeEmgZgAZO4Oqrr46NN944jjjiiIGrY5111olTTz01xo0bVz0lPj013kKAAAECBAgQ6AWBlqfABg581KhR8eSTT8bixYsHrq5epwelrr/++tUpsbU2WkGAAAECBAgQKFSgYwDab7/9ql97Pvroo+Oee+6Jl19+ORYtWhRXXHFFTJ06tTpVlkKQhQABAgQIECDQKwIdT4GNHDkyZs+eHYcddljsvPPOa8xr4sSJcdFFF62xzhsCBAgQIECAQOkCHQNQmkB6IvwDDzxQHQGaO3dujBkzJnbbbbfYaqutSp9fbeN7cdF6MXWro2trX8MEljx2AQQCtQmMDv9/1Yar4XjHeyL2LdxhUAEozWH48OFV6EnBx0KAAAECBAgQ6GWBlgHojjvuiPTjhpMnT64ufp41a9a/neO0adP+7XYbCRAgQIAAAQIlCbQNQKeffnp13U96Gnx6/e8WAejf6dhGgAABAgQIlCbQMgAdf/zxkf7Skn75Od31ZSFAgAABAgQI9ItAx9vgb7vttjjttNPioYce6pc5mwcBAgQIECDQcIGOASj94vN5550X73jHO2KvvfaKn/70p/Hiiy82nM30CRAgQIAAgV4W6BiA0l1fTzzxRFx55ZWxxRZbxHHHHRfpsRdHHXVU3Hzzzb08d2MnQIAAAQIEGirQMQAll6FDh8aBBx4YP/vZz+Kpp56K6dOnV4/H2GeffaojQw21M20CBAgQIECgRwUGFYAGzi09BX7ZsmXV4zFWrlxZ/T7QwO1eEyBAgAABAgRKFxhUAErP/7r00ktjwoQJsfnmm0e67X277baLW265Je69997S52h8BAgQIECAAIE1BFreBj/wE+mJ7wcccEAsXbo00imvCy+8MA4//PBYb731Bn7MawIECBAgQIBAzwh0DEBpJl/84hdj0qRJjX72V89U1EAJECBAgACBjgItA9DAR2Fssskmse6661YXQLdrzS9Bt5OxngABAgQIEChRoG0A8iiMEstlTAQIECBAgMB/Q6BlAPIojP8GrTYIECBAgACBUgUGdRdYqYM3LgIECBAgQIDAGxFoeQRo5syZMWPGjEG3d/311w/6sz5IgAABAgQIEMgt0PII0IgRI2LTTTdd/ffMM8/EDTfcEOmHD9PT4UePHh1z5syp1o0dOzb3HPRPgAABAgQIEHhdAi2PAB188MGR/tKyYMGC2GmnneKSSy6JI488cnXj6Rehp0yZEvPmzVu9zgsCBAgQIECAQC8ItAxAAwd+9dVXx8YbbxxHHHHEwNWRnhJ/6qmnxrhx42LhwoXVA1LX+IA3BAgQIECAAIFCBVqeAhs41lGjRlUPPl28ePHA1dXr9CvR66+/fnVKbK2NVhAgQIAAAQIEChXoGID222+/6sGnRx99dNxzzz2Rngu2aNGiuOKKK2Lq1KnVqbIUgiwECBAgQIAAgV4R6HgKbOTIkTF79uw47LDDYuedd15jXhMnToyLLrpojXXeECBAgAABAgRKF+gYgNIExo8fHw888EB1BGju3LkxZsyY2G233TwbrPTqGh8BAgQIECDQUmBQASh9c/jw4VXoScHHQoAAAQIECBDoZYFBBaBbb701zj777Hj88cdj2bJla803/SaQhQABAgQIECDQKwIdA9D8+fPjgAMOqO702n333SPdFWYhQIAAAQIECPSyQMcAdN1118Wb3vSmSNf+bLTRRr08V2MnQIAAAQIECFQCHW+DT4+/SI+7EH7sMQQIECBAgEC/CHQMQHvvvXc8/PDDcd999/XLnM2DAAECBAgQaLhAx1Ng6623XvUYjD333DM++clPVkeDhg4dugbbKaecssZ7bwgQIECAAAECJQt0DEB33313zJo1q5pDeiBqq0UAaqViHQECBAgQIFCqQMcAtP/++8eSJUtKHb9xESBAgAABAgRet0DHa4Bed4u+QIAAAQIECBAoXKDtEaAVK1YMeujpNnkLAQIECBAgQKBXBFoml7POOivShc6D/euVyRonAQIECBAgQCAJtDwClH7x+bTTTiNEgAABAgQIEOhLgZYBaI899oj0ZyFAgAABAgQI9KNAy1Ng/ThRcyJAgAABAgQIrBIQgFZJ+JcAAQIECBBojIAA1JhSmygBAgQIECCwSkAAWiXhXwIECBAgQKAxAi0vgm7M7P+DiW6w0cvxo8cu+A9a8FUCBAjkE/if6fn61nP/C+y45Wtz3KfseToCVHZ9jI4AAQIECBCoQUAAqgFVkwQIECBAgEDZAgJQ2fUxOgIECBAgQKAGAQGoBlRNEiBAgAABAmULCEBl18foCBAgQIAAgRoEBKAaUDVJgAABAgQIlC0gAJVdH6MjQIAAAQIEahAQgGpA1SQBAgQIECBQtoAAVHZ9jI4AAQIECBCoQUAAqgFVkwQIECBAgEDZAgJQ2fUxOgIECBAgQKAGAQGoBlRNEiBAgAABAmULCEBl18foCBAgQIAAgRoEBKAaUDVJgAABAgQIlC0gAJVdH6MjQIAAAQIEahAQgGpA1SQBAgQIECBQtoAAVHZ9jI4AAQIECBCoQUAAqgFVkwQIECBAgEDZAgJQ2fUxOgIECBAgQKAGAQGoBlRNEiBAgAABAmULCEBl18foCBAgQIAAgRoEBKAaUDVJgAABAgQIlC0gAJVdH6MjQIAAAQIEahAQgGpA1SQBAgQIECBQtoAAVHZ9jI4AAQIECBCoQUAAqgFVkwQIECBAgEDZAgJQ2fUxOgIECBAgQKAGAQGoBlRNEiBAgAABAmULCEBl18foCBAgQIAAgRoEBKAaUDVJgAABAgQIlC0gAJVdH6MjQIAAAQIEahAQgGpA1SQBAgQIECBQtoAAVHZ9jI4AAQIECBCoQUAAqgFVkwQIECBAgEDZAgJQ2fUxOgIECBAgQKAGAQGoBlRNEiBAgAABAmULCEBl18foCBAgQIAAgRoEBKAaUDVJgAABAgQIlC0gAJVdH6MjQIAAAQIEahAQgGpA1SQBAgQIECBQtoAAVHZ9jI4AAQIECBCoQUAAqgFVkwQIECBAgEDZAsPKHl65o3tx0Xoxdaujyx2gkREgQIAAAQJtBRwBaktjAwECBAgQINCvAgJQv1bWvAgQIECAAIG2AgJQWxobCBAgQIAAgX4VEID6tbLmRYAAAQIECLQVEIDa0thAgAABAgQI9KuAANSvlTUvAgQIECBAoK2AANSWxgYCBAgQIECgXwUEoH6trHkRIECAAAECbQUEoLY0NhAgQIAAAQL9KiAA9WtlzYsAAQIECBBoKyAAtaWxgQABAgQIEOhXAQGoXytrXgQIECBAgEBbAQGoLY0NBAgQIECAQL8KCED9WlnzIkCAAAECBNoKCEBtaWwgQIAAAQIE+lVAAOrXypoXAQIECBAg0FZAAGpLYwMBAgQIECDQrwICUL9W1rwIECBAgACBtgICUFsaGwgQIECAAIF+FRCA+rWy5kWAAAECBAi0FRCA2tLYQIAAAQIECPSrgADUr5U1LwIECBAgQKCtgADUlsYGAgQIECBAoF8FBKB+rax5ESBAgAABAm0FBKC2NDYQIECAAAEC/SogAPVrZc2LAAECBAgQaCsgALWlsYEAAQIECBDoVwEBqF8ra14ECBAgQIBAWwEBqC2NDQQIECBAgEC/CghA/VpZ8yJAgAABAgTaCghAbWlsIECAAAECBPpVQADq18qaFwECBAgQINBWQABqS2MDAQIECBAg0K8CAlC/Vta8CBAgQIAAgbYCAlBbGhsIECBAgACBfhUQgPq1suZFgAABAgQItBUQgNrS2ECAAAECBAj0q4AA1K+VNS8CBAgQIECgrYAA1JbGBgIECBAgQKBfBQSgfq2seREgQIAAAQJtBQSgtjQ2ECBAgAABAv0qMGTla0u/Tq72eZGrnVgHBAgQINCDAkPKH/Ow8odY8Ah7oMAF6xkaAQIECBDIJuAUWDZ6HRMgQIAAAQK5BASgXPL6JUCAAAECBLIJCEDZ6HVMgAABAgQI5BIQgHLJ65cAAQIECBDIJiAAZaPXMQECBAgQIJBLQADKJa9fAgQIECBAIJuAAJSNXscECBAgQIBALgEBKJe8fgkQIECAAIFsAgJQNnodEyBAgAABArkEBKBc8volQIAAAQIEsgkIQNnodUyAAAECBAjkEhCAcsnrlwABAgQIEMgmIABlo9cxAQIECBAgkEtAAMolr18CBAgQIEAgm4AAlI1exwQIECBAgEAuAQEol7x+CRAgQIAAgWwCAlA2eh0TIECAAAECuQQEoFzy+iVAgAABAgSyCQhA2eh1TIAAAQIECOQSEIByyeuXAAECBAgQyCYgAGWj1zEBAgQIECCQS0AAyiWvXwIECBAgQCCbgACUjV7HBAgQIECAQC4BASiXvH4JECBAgACBbAICUDZ6HRMgQIAAAQK5BASgXPL6JUCAAAECBLIJCEDZ6HVMgAABAgQI5BIQgHLJ65cAAQIECBDIJiAAZaPXMQECBAgQIJBLQADKJa9fAgQIECBAIJuAAJSNXscECBAgQIBALgEBKJe8fgkQIECAAIFsAgJQNnodEyBAgAABArkEBKBc8volQIAAAQIEsgkIQNnodUyAAAECBAjkEhCAcsnrlwABAgQIEMgmIABlo9cxAQIECBAgkEtAAMolr18CBAgQIEAgm4AAlI1exwQIECBAgEAuAQEol7x+CRAgQIAAgWwCAlA2eh0TIECAAAECuQQEoFzy+iVAgAABAgSyCQhA2eh1TIAAAQIECOQSEIByyeuXAAECBAgQyCYgAGWj1zEBAgQIECCQS0AAyiWvXwIECBAgQCCbgACUjV7HBAgQIECAQC4BASiXvH4JECBAgACBbAICUDZ6HRMgQIAAAQK5BASgXPL6JUCAAAECBLIJCEDZ6HVMgAABAgQI5BIQgHLJ65cAAQIECBDIJiAAZaPXMQECBAgQIJBLQADKJa9fAgQIECBAIJuAAJSNXscECBAgQIBALgEBKJe8fgkQIECAAIFsAgJQNnodEyBAgAABArkEBKBc8volQIAAAQIEsgkIQNnodUyAAAECBAjkEhCAcsnrlwABAgQIEMgmIABlo9cxgf4WGD9+fAwZMiQmTZrUcqILFy6MoUOHVp+ZP39+y88MduU111xTtfPwww8P9is+R4BAwwUEoIbvAKZPoE6BFHAuv/zy+Oc//7lWN7/+9a9jxYoVa623ggABAt0QEIC6oawPAg0V+NCHPhSLFi2KG2+8cS2BSy+9NHbbbbe11ltBgACBbggIQN1Q1geBhgpsueWW8YEPfCDS0Z6By9NPPx1/+tOf4mMf+9jA1dXr9NkUnN785jfHZpttFgceeGD87W9/W/25r371q3HaaafFKaecEm9961tj6tSpq7etevHSSy/FYYcdVrWfXqflhRdeiOOOOy7GjRsXG2+8cUyYMCH+8Y9/rPpKzJ49O/bYY4/44x//GGPHjo0999wznn/++bjjjjuq1yNHjoytt966OqWX1lsIEOhtAQGot+tn9ASKFzj88MPjt7/9baxcuXL1WH/zm99EukYoBYqBSzoqlELRLrvsEhdccEEce+yx8de//nWNoPToo49W2375y1/GAQccEJtsssnAJmL58uXV5//yl7/EGWecESNGjKj63meffeJXv/pVfPrTn47zzz+/OjL13ve+two5qYElS5ZUYeezn/1sfOQjH6kC2PDhw+Oggw6KDTfcMC688MI46aSTqoB05JFHrtGnNwQI9J7AsN4bshETINBLAikAnXzyyXHbbbdVR1jS2FPQ+fjHP77WNG699dY45JBD4pxzzqm2paM46667bnzpS1+KxYsXx5gxY6r1CxYsiPvvvz/e+c53Vu/TRdBpSdcUfepTn4q77rorbrrppthmm22q9SkspSM5v//976sjSmnlqvB05plnxre//e3qc6+++mqkAJT6S0v6znPPPRff/OY3q8CW1m2xxRZxyy23VKEqXeRtIUCgNwUEoN6sm1ET6BmBFEJ23XXXSEd90immFCjSNUEzZsyIOXPmrDGP733ve6vfP/nkk3HffffFvHnzqnXpVNaqAJROja0KP6u/8NqLE088Ma688srqiNP222+/etPNN98co0ePjnQaK4WsVUs60jTwfVqfTn2tWnbcccfq6E8KcZ/5zGeqcJZCWfqzECDQ2wJOgfV2/YyeQE8IpACx6jqgFITe/e53x7bbbrvW2FM4Ouqoo6rTT+n6oUmv3UL/4IMPVp8beAotXaPTaknX8bz97W+P73//+2ucckunzdIprg9/+MPxwQ9+cPVfCj8DrwNKbQ5se4MNNojrrruuumboy1/+cuy8885V8LrssstadW8dAQI9JCAA9VCxDJVArwqk63rSb/Tcfffd1XU4EydObDmVdG3NFVdcEaeffnr8/e9/jyeeeCKmTJlSfXZgAEq317daZs6cGeedd151+usnP/nJ6o+85S1vqYJROsWVTpMN/PvX3w7617bf9773RbqeKIWoH/3oR5GuC0pHgB555JHV7XtBgEDvCQhAvVczIybQcwI77LBDpFNSl1xySVx//fUtr/9ZtmxZXHvttXH88cfH5MmTY7vttqvmeeedd1b/pvDSaUnf+ehHPxqf+MQnquuOnnrqqeor6VRWOtJz++23Vz+YmK7dSYHqiCOOiHQNULslXeuz1157xbPPPlsFqBTGLr744ipAzZ07t93XrCdAoAcEBKAeKJIhEugHgXQUaPr06VUQanX9TrrYOd0yn44ApbCydOnS6m6tdNQlLatuZx+MRToFln58MV0TlJZjjjkm0lGgFGDS6at0fdG0adNi1qxZse+++7ZtMt2pli62PuGEE6p/01Ggc889N4YNG7b6gu62X7aBAIGiBQSgostjcAT6RyBdB5SO8rS6+2vVLL/+9a9XL9Pt8SmwpKMt6W6udFoqHb0Z7JLu1PrGN74Rv/jFL+IPf/hDdfF0OrqUlkMPPbS6zidd25PuNkshp92SbqH/8Y9/XAWynXbaqbpt/6qrrqra/Nfb79u1YT0BAmUKDHntMPD//zhHmWM0KgIEGiaQnhOWwseoUaP+6zNPt9O//PLL1Y8svp7G0xGpF198MTbffPPX8zWfJUCgUAEBqNDCGBYBAgQIECBQn4BTYPXZapkAAQIECBAoVEAAKrQwhkWAAAECBAjUJyAA1WerZQIECBAgQKBQAQGo0MIYFgECBAgQIFCfgABUn62WCRAgQIAAgUIFBKBCC2NYBAgQIECAQH0CAlB9tlomQIAAAQIEChUQgAotjGERIECAAAEC9QkIQPXZapkAAQIECBAoVEAAKrQwhkWAAAECBAjUJyAA1WerZQIECBAgQKBQAQGo0MIYFgECBAgQIFCfgABUn62WCRAgQIAAgUIFBKBCC2NYBAgQIECAQH0CAlB9tlomQIAAAQIEChUQgAotjGERIECAAAEC9QkIQPXZapkAAQIECBAoVEAAKrQwhkWAAAECBAjUJyAA1WerZQIECBAgQKBQAQGo0MIYFgECBAgQIFCfgABUn62WCRAgQIAAgUIFBKBCC2NYBAgQIECAQH0C/wfPvd4g52t6YAAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
</div>
<div id="input-data" class="section level1">
<h1>Input data</h1>
<p>The <code>diemr</code> package uses a consise genome representation.
Let’s have a small dataset of three markers genotyped for six
individuals.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>S001122</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>S121000</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>S02221U</span></code></pre></div>
<p>The genotypes encoded as <code>0</code> represent homozygots for an
allele attributed to barrier side A, <code>1</code> are heterozygous
genotypes, <code>2</code> are homozygots for another allele, attributed
to barrier side B, and <code>U</code> (symbol “_” is also allowed)
represents an unknown state or a third (fourth) allele. The power of
<code>diem</code> lies in the safety that the user does not need to
determine the true assignment to the barrier sides A and B before the
analysis and the specific genotypes encoded as <code>0</code> and
<code>2</code> respectively can be arbitrary.</p>
<p>The leading <code>S</code> on each line of the input file is needed
to ensure that the marker genotypes are read in as a string on all
operating systems. The <code>S</code> is dropped during import of the
genotypes, and the dataset is imported as a character matrix of all
markers.</p>
</div>
<div id="multiple-compartments-with-different-ploidies" class="section level1">
<h1>Multiple compartments with different ploidies</h1>
<p>Some genomic compartments differ between individuals in their ploidy.
For example, markers located on chromosome X in mammals will be diploid
in females, but haploid in males. Ploidy differences between individuals
influence calculation of the hybrid index, which in turn has an effect
on the <em>diem</em> analysis.</p>
<p>To set up the <em>diem</em> analysis with multiple compartments, the
markers with different individual ploidies must be stored in separate
files. The file analysed in the <strong>Quick start</strong> chapter
could contain markers from autosomes and an additional file will contain
markers from an X chromosome, with individuals 2 and 6 being males. The
respective ploidies for the second genomic compartment will be
<code>c(2, 1, 2, 2, 2, 1)</code>.</p>
<p>Arguments <code>files</code> and <code>ploidy</code> will need to
reflect the information, taking care that the order of filenames
corresponds to the order of elements in the list of ploidies.
<code>diem</code> cannot check that the order of the elements is
correct, only that the information is in the correct format.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>filepaths2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;data6x3.txt&quot;</span>, <span class="at">package =</span> <span class="st">&quot;diemr&quot;</span>),</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;data7x10.txt&quot;</span>, <span class="at">package =</span> <span class="st">&quot;diemr&quot;</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>ploidies2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">6</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">CheckDiemFormat</span>(<span class="at">files =</span> filepaths2, </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">ChosenInds =</span> samples,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">ploidy =</span> ploidies2)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># File check passed: TRUE</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ploidy check passed: TRUE</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for repeatibility of null polarities (optional)</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">39583782</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Run diem with verbose = TRUE to store hybrid indices with ploidy-aware allele counts</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">diem</span>(<span class="at">files =</span> filepaths2, </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ploidy =</span> ploidies2, </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">markerPolarity =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">ChosenInds =</span> samples, </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">nCores =</span> <span class="dv">1</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Plotting polarised genomes from multiple compartments requires
separate import of the compartment data. The polarities in the
<code>res2$markerPolarity</code> element are combined across all
compartments, and extracting them requires knowledge of the number of
markers in each compartment. Alternatively, the marker polarities from
each compartment can be extracted from the list in the
<code>res2$PolarityChanges</code> element.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import each compartment into a list</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>genotypes2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">importPolarized</span>(<span class="at">file =</span> filepaths2[<span class="dv">1</span>], </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">changePolarity =</span> res2<span class="sc">$</span>markerPolarity[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ChosenInds =</span> samples),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">importPolarized</span>(<span class="at">file =</span> filepaths2[<span class="dv">2</span>], </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">changePolarity =</span> res2<span class="sc">$</span>markerPolarity[<span class="dv">4</span><span class="sc">:</span><span class="dv">13</span>], </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ChosenInds =</span> samples)) </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind compartment genotypes into one matrix</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>genotypes2 <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(cbind, genotypes2)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Load individual hybrid indices from a stored file</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>h2 <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">read.table</span>(<span class="st">&quot;diagnostics/HIwithOptimalPolarities.txt&quot;</span>))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the polarised genotypes</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plotPolarized</span>(<span class="at">genotypes =</span> genotypes2,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">HI =</span> h2)</span></code></pre></div>
<p><img src="data:image/png;base64,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gAABAgQItE5AAGpdyxVMgAABAgQICED2AQIECBAgQKB1AgJQ61quYAIECBAgQEAAsg8QIECAAAECrRMQgFrXcgUTIECAAAECApB9gAABAgQIEGidgADUupYrmAABAgQIEBCA7AMECBAgQIBA6wQEoNa1XMEECBAgQICAAGQfIECAAAECBFonIAC1ruUKJkCAAAECBAQg+wABAgQIECDQOgEBqHUtVzABAgQIECAgANkHCBAgQIAAgdYJCECta7mCCRAgQIAAAQHIPkCAAAECBAi0TkAAal3LFUyAAAECBAgIQPYBAgQIECBAoHUCAlDrWq5gAgQIECBAQACyDxAgQIAAAQKtExCAWtdyBRMgQIAAAQICkH2AAAECBAgQaJ2AANS6liuYAAECBAgQEIDsAwQIECBAgEDrBASg1rVcwQQIECBAgIAAZB8gQIAAAQIEWicgALWu5QomQIAAAQIEBCD7AAECBAgQINA6AQGodS1XMAECBAgQICAA2QcIECBAgACB1gkIQK1ruYIJECBAgAABAcg+QIAAAQIECLROQABqXcsVTIAAAQIECAhA9gECBAgQIECgdQICUOtarmACBAgQIEBAALIPECBAgAABAq0TEIBa13IFEyBAgAABAkMQvHmBhS+88ObfXPA71x0+PJvqcuoRl2x2i56ZyLrDXsxmrgtfHJbNXHKaSE7/XSeXXP7mrbXGGjHs9Z+cl0FLX19ynmCuc0s72dj/mZzr9FbrvBafPWW1br/vxkcfd2zfh6v1dy6rlb8nN774hOnZzHv0GROymUtOE8npv+vkksvfvG8dcGAct8ceObWqNhenwGokBggQIECAAIHSBQSg0jusPgIECBAgQKAmIADVSAwQIECAAAECpQsIQKV3WH0ECBAgQIBATUAAqpEYIECAAAECBEoXEIBK77D6CBAgQIAAgZqAAFQjMUCAAAECBAiULiAAld5h9REgQIAAAQI1AQGoRmKAAAECBAgQKF1AACq9w+ojQIAAAQIEagICUI3EAAECBAgQIFC6gABUeofVR4AAAQIECNQEBKAaiQECBAgQIECgdAEBqPQOq48AAQIECBCoCQhANRIDBAgQIECAQOkCAlDpHVYfAQIECBAgUBMQgGokBggQIECAAIHSBQSg0jusPgIECBAgQKAmIADVSAwQIECAAAECpQsIQKV3WH0ECBAgQIBATUAAqpEYIECAAAECBEoXEIBK77D6CBAgQIAAgZqAAFQjMUCAAAECBAiULiAAld5h9REgQIAAAQI1AQGoRmKAAAECBAgQKF1AACq9w+ojQIAAAQIEagICUI3EAAECBAgQIFC6gABUeofVR4AAAQIECNQEBKAaiQECBAgQIECgdAEBqPQOq48AAQIECBCoCQhANRIDBAgQIECAQOkCAlDpHVYfAQIECBAgUBMQgGokBggQIECAAIHSBQSg0jusPgIECBAgQKAmIADVSAwQIECAAAECpQsIQKV3WH0ECBAgQIBATUAAqpEYIECAAAECBEoXEIBK77D6CBAgQIAAgZqAAFQjMUCAAAECBAiULiAAld5h9REgQIAAAQI1AQGoRmKAAAECBAgQKF1gSOkFDlR96w57MRafMH2gVt/T6500KJ/pL34knx6NPi4jF/tuPs14g5mMPmPCGzzb3acWnz2luxvsla3NG5HZTPPZZzKDqU3HEaAaiQECBAgQIECgdAEBqPQOq48AAQIECBCoCQhANRIDBAgQIECAQOkCAlDpHVYfAQIECBAgUBMQgGokBggQIECAAIHSBQSg0jusPgIECBAgQKAmIADVSAwQIECAAAECpQsIQKV3WH0ECBAgQIBATUAAqpEYIECAAAECBEoXEIBK77D6CBAgQIAAgZqAAFQjMUCAAAECBAiULiAAld5h9REgQIAAAQI1AQGoRmKAAAECBAgQKF1AACq9w+ojQIAAAQIEagICUI3EAAECBAgQIFC6gABUeofVR4AAAQIECNQEBKAaiQECBAgQIECgdAEBqPQOq48AAQIECBCoCQhANRIDBAgQIECAQOkCAlDpHVYfAQIECBAgUBMQgGokBggQIECAAIHSBQSg0jusPgIECBAgQKAmIADVSAwQIECAAAECpQsIQKV3WH0ECBAgQIBATUAAqpEYIECAAAECBEoXEIBK77D6CBAgQIAAgZqAAFQjMUCAAAECBAiULiAAld5h9REgQIAAAQI1AQGoRmKAAAECBAgQKF1AACq9w+ojQIAAAQIEagICUI3EAAECBAgQIFC6gABUeofVR4AAAQIECNQEBKAaiQECBAgQIECgdAEBqPQOq48AAQIECBCoCQhANRIDBAgQIECAQOkCAlDpHVYfAQIECBAgUBMQgGokBggQIECAAIHSBQSg0jusPgIECBAgQKAmIADVSAwQIECAAAECpQsIQKV3WH0ECBAgQIBATUAAqpEYIECAAAECBEoXEIBK77D6CBAgQIAAgZrAkNqIgX4JPL9wWJy82YR+vbYbL5r6yPRubKZf2/jfY/v1sq68aGpXttJ7Gxl9Rj77bu/pdW/Gn53SvW113NLZHV/RvRfMG9G9bXXY0qSM/j+QpvrZDvPt1tPbbvL6lvbo1tbe3HYcAXpzbt5FgAABAgQI9LCAANTDzTN1AgQIECBA4M0JCEBvzs27CBAgQIAAgR4WEIB6uHmmToAAAQIECLw5gX4HoKVLly7fwpNPPhm///3vY/78+cvH/EKAAAECBAgQ6BWBfgWgc889N7bZZpuqpgceeCC23nrrOOigg2LTTTeNK6+8sldqNU8CBAgQIECAQCXQMQDdf//9cdxxx8Wuu+4a6SjQ6aefHkOGDIlbbrklJk6cGEceeSRKAgQIECBAgEBPCXQMQLfddltsueWWMW3atBg0aFBcdtllccghh8TOO+8ckydPjkcffTQWLFjQU0WbLAECBAgQINBugY4B6Jlnnon111+/UpozZ048/vjjsffee1ePX3rppepo0PDhw9utqHoCBAgQIECgpwQ6BqDtt98+Zs+eHTfeeGOceeaZsdZaa8Vee+0VS5Ysie9+97vxoQ99KEaNGtVTRZssAQIECBAg0G6BjrfC2H333WP//feP3XbbrZL68Y9/HCNHjowjjjiiOh123nnntVtQ9QQIECBAgEDPCXQMQKmiGTNmxNy5c2P06NExZsyYqsh0AfRZZ53l6E/PtdyECRAgQIAAgX4FoHTx87bbbruC1vvf//4VHntAgAABAgQIEOgVgcYAdOedd8ZNN93U7xqOPTaj23/3e9ZeSIAAAQIECLRVoDEA3XDDDdVH3PuLIgD1V8rrCBAgQIAAgRwEGj8F9uUvfznSR9z7+5NDIeZAgAABAgQIEOivQGMA6u+b0+sWLly4Ki/3WgIECBAgQIDAahdoPAX2n7O65ppr4pxzzomnn346Xn311erp9O8LL7wQ6VYZ6UiRhQABAgQIECDQKwIdjwDNmzcvDjjggOreX2ussUakb4PecMMNY9GiRXHPPffE97///V6p1TwJECBAgAABApVAxyNAs2bNitdeey3SXeDTUZ90W4yLLrooRowYEUcffXQ8+OCDKAkQIECAAAECPSXQ8QjQ/Pnzq9tdrL322tUXIW600UaRbpCavhvo61//epx//vnxyiuv9FTRJkuAAAECBAi0W6BjANp8883joYceWq703ve+N26++ebq8brrrlv9m+4IbyFAgAABAgQI9IpAxwC08847V9f7HH744dUnvtLjdAosXQv0gx/8oDolNnbs2F6p1zwJECBAgAABAtExAKULnqdPnx5XXnllLFiwoLruJ10TlO4S/81vfjOOOuqo6nQYSwIECBAgQIBArwh0vAg6FTJ+/Pg48MADY/DgwdXPHXfcEVdffXWk+4FtscUWvVKreRIgQIAAAQIEKoGOAegvf/lLx9tipFtnWAgQIECAAAECvSLQMQANHTo00ie/+i5LliyJ++67L9LFz8cff3zfp/xOgAABAgQIEMheoGMA2nHHHeMXv/hFrZClS5fGl770pXjkkUdqzxkgQIAAAQIECOQs0PEi6JVNPn0P0AknnBAzZ86M5557bmUvM06AAAECBAgQyE7gTQegVMkTTzxRfTv04sWLsyvMhAgQIECAAAECKxPoeArs4YcfjksvvXSF96dbYjz77LPVt0CnL0bcZJNNVnjeAwIECBAgQIBAzgIdA9DcuXPjxBNPrNWQ7gW2ww47xNlnn117zgABAgQIECBAIGeBjgFov/32i5deeinnGsyNAAECBAgQILBKAv/VNUCrtCUvJkCAAAECBAhkItB4BGjGjBkxbdq0fk/xuuuu6/drvZAAAQIECBAgsLoFGo8ADR8+PDbYYIPlP0899VRcf/31kb77Z+utt47Ro0fH7Nmzq7ExY8as7hpsnwABAgQIECCwSgKNR4D233//SD9pmT9/fmy33XZx8cUXx2GHHbZ85a+88kpMnDgx0kXSFgIECBAgQIBALwk0BqC+BVx11VWx3nrrxaGHHtp3ONZYY4045ZRTYuzYsdVd4tNd4y0ECBAgQIAAgV4QaDwF1nfio0aNiscffzwWLVrUd7j6Pd0oda211qpOidWeNECAAAECBAgQyFSgYwDaa6+9qm97njBhQtx9993x4osvxsKFC+Pyyy+Pk08+uTpVlkKQhQABAgQIECDQKwIdT4GNHDkyZs2aFQcffHCMGzduhbrGjx8fF1544QpjHhAgQIAAAQIEchcY9Ponu5b2Z5LpyxDTEaA5c+bEOuusEzvttFNsttlm/Xlrma957dmI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KFxAACq8wcojQIAAAQIE6gICUN3ECAECBAgQIFC4gABUeIOVR4AAAQIECNQFBKC6iRECBAgQIECgcAEBqPAGK48AAQIECBCoCwhAdRMjBAgQIECAQOECg5a+vhRe48CVR27gbK15YAUGDezqrf0tEvA35i2CHMDV+G9pAHEHdtVDBnb1ha/djl94g5VHYDUL+Buzmhtg8yULOAVWcnfVRoAAAQIECDQKCECNLAYJECBAgACBkgUEoJK7qzYCBAgQIECgUUAAamQxSIAAAQIECJQsIACV3F21ESBAgAABAo0CAlAji0ECBAgQIECgZAEBqOTuqo0AAQIECBBoFBCAGlkMEiBAgAABAiULCEAld1dtBAgQIECAQKOAANTIYpAAAQIECBAoWUAAKrm7aiNAgAABAgQaBQSgRhaDBAgQIECAQMkCAlDJ3VUbAQIECBAg0CggADWyGCRAgAABAgRKFhCASu6u2ggQIECAAIFGAQGokcUgAQIECBAgULKAAFRyd9VGgAABAgQINAoIQI0sBgkQIECAAIGSBQSgkrurNgIECBAgQKBRQABqZDFIgAABAgQIlCwgAJXcXbURIECAAAECjQICUCOLQQIECBAgQKBkAQGo5O6qjQABAgQIEGgUEIAaWQwSIECAAAECJQsIQCV3V20ECBAgQIBAo4AA1MhikAABAgQIEChZQAAqubtqI0CAAAECBBoFBKBGFoMECBAgQIBAyQICUMndVRsBAgQIECDQKCAANbIYJECAAAECBEoWEIBK7q7aCBAgQIAAgUYBAaiRxSABAgQIECBQsoAAVHJ31UaAAAECBAg0CghAjSwGCRAgQIAAgZIFBKCSu6s2AgQIECBAoFFAAGpkMUiAAAECBAiULCAAldxdtREgQIAAAQKNAgJQI4tBAgQIECBAoGQBAajk7qqNAAECBAgQaBQQgBpZDBIgQIAAAQIlCwhAJXdXbQQIECBAgECjgADUyGKQAAECBAgQKFlAACq5u2ojQIAAAQIEGgUEoEYWgwQIECBAgEDJAgJQyd1VGwECBAgQINAoIAA1shgkQIAAAQIEShYQgErurtoIECBAgACBRgEBqJHFIAECBAgQIFCygABUcnfVRoAAAQIECDQKCECNLAYJECBAgACBkgUEoJK7qzYCBAgQIECgUUAAamQxSIAAAQIECJQsIACV3F21ESBA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" style="display: block; margin: auto;" /></p>
</div>
<div id="frequently-asked-questions" class="section level1">
<h1>Frequently asked questions</h1>
<ol style="list-style-type: decimal">
<li><strong>How can I install <code>diemr</code> from the
source?</strong></li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="at">package =</span> <span class="st">&quot;diemr_1.1.tar.gz&quot;</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repos =</span> <span class="cn">NULL</span>, <span class="at">type =</span> <span class="st">&quot;source&quot;</span>)</span></code></pre></div>
<p>Make sure to set the <code>R</code> working directory to the folder,
where the package tarball is stored, or include a full path to the file
within the quotes. Update the version number to the specific file.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>How can I calculate the hybrid indices from my polarised
data?</strong></li>
</ol>
<p>There are two options. First, use <code>diem</code> with argument
<code>verbose = TRUE</code> and the hybrid indices will be stored in a
text file in the diagnostics folder in the working directory. The stored
values will be ploidy-aware. However, these hybrid indices could include
the bias introduced by the small data correction if the data warranted
it. The user might prefer to calculate the hybrid indices without the
small data correction. For this, use the <code>I4</code> matrix in the
<code>diem</code> output.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(res<span class="sc">$</span>I4, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> pHetErrOnStateCount)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#          [,1] [,2]      [,3]      [,4]      [,5]      [,6]</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># p   0.5000000    0 0.3333333 0.5000000 0.8333333 1.0000000</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Het 0.3333333    0 0.6666667 0.3333333 0.3333333 0.0000000</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Err 0.0000000    0 0.0000000 0.0000000 0.0000000 0.3333333</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><strong>I expect more than two groups of samples in my data. Can I
use <code>diemr</code>?</strong></li>
</ol>
<p>Yes. Multiple barriers to geneflow between multiple groups of samples
can be identified iteratively with help from the argument
<code>ChosenInds</code>. For example, let’s assume that the individual 2
was identified as belonging to one side of the barrier and being
separated from other by the steepest change in the hybrid index. In the
next <code>diem</code> run, we exclude the individual 2, adjusting the
ploidies to reflect the omission.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ploidies2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>samples2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">CheckDiemFormat</span>(<span class="at">files =</span> filepaths, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">ChosenInds =</span> samples2, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">ploidy =</span> ploidies2)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># File check passed: TRUE</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ploidy check passed: TRUE</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">diem</span>(<span class="at">files =</span> filepaths, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">ChosenInds =</span> samples2,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">ploidy =</span> ploidies2,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">nCores =</span> <span class="dv">1</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">markerPolarity =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate hybrid indices from updated I4</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>h.res2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(res2<span class="sc">$</span>I4, </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">MARGIN =</span> <span class="dv">1</span>, </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">FUN =</span> pHetErrOnStateCount)[<span class="dv">1</span>, ]</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co"># set names for the hybrid index values</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>h.res2 <span class="ot">&lt;-</span> <span class="fu">setNames</span>(h.res2, <span class="at">nm =</span> samples2)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#    1    3    4    5    6 </span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.50 0.33 0.50 0.83 1.00 </span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the center of the maximum hybrid index change</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>diffs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">rollmean =</span> zoo<span class="sc">::</span><span class="fu">rollmean</span>(<span class="fu">sort</span>(h.res2), <span class="at">k =</span> <span class="dv">2</span>),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">diff =</span> <span class="fu">diff</span>(<span class="fu">sort</span>(h.res2), <span class="at">lag =</span> <span class="dv">1</span>))</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>h.res2.c <span class="ot">&lt;-</span> diffs<span class="sc">$</span>rollmean[<span class="fu">which.max</span>(diffs<span class="sc">$</span>diff)]</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] 0.6666667</span></span></code></pre></div>
<p>Since the center of the barrier is at 0.67 now, <code>diem</code>
separated individuals 1, 3, and 4 from a group that includes 5, 6.
Combined with the result from the first <code>diem</code> run, we have
identified three groups in the dataset: (2), (1, 3, 4), and (5, 6).</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>The hybrid indices in my dataset are too similar. I expected
them to look more like the rescaled hybrid indices. What is
wrong?</strong></li>
</ol>
<p>The input data probably contains invariant sites, which weight the
hybrid indices to be similar between individuals. Make sure to use only
variable sites. Alternatively, filter sites with lowest diagnostic index
after the <code>diem</code> analysis and recalculate the hybrid indices
with the filtered data.</p>
<ol start="5" style="list-style-type: decimal">
<li><strong>How to cite <code>diemr</code>?</strong></li>
</ol>
<p>To use <code>diemr</code> in a publication, please cite:</p>
<blockquote>
<p>Baird S. J. E., Petruzela J., Jaron I., Skrabanek P., Martinkova N.
2023. Genome polarisation for detecting barriers to geneflow. Methods in
Ecology and Evolution, 14: 512–528. doi: 10.1111/2041-210X.14010.</p>
</blockquote>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
